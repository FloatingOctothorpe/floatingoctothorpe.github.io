<!DOCTYPE html>
<html lang="en-GB">
<head>
  <title>Floating Octothorpe: Python for else?</title>

  <meta charset="utf-8" />
  <meta name="Author" content="Floating Octothorpe" />
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="icon" type="image/png" href="/img/favicon.png" />
</head>
<body>
  <header>
    <a href="/"><img class="logo" src="/img/logo.png" alt="Floating Octothorpe logo"/></a>
    <h1 class="site-title">Floating Octothorpe</h1>
    <nav>
      <ul>
        <li><a href="/">Latest</a></li>
        <li><a href="/archive.html">Archive</a></li>
        <li><a href="/about.html">About</a></li>
      </ul>
    </nav>
  </header>
  <article>
<h1>Python for else?</h1>

<time datetime="2016-10-14">14 October 2016</time>

<p>I've used <a href="https://www.python.org/">Python</a> for longer than I care to admit. It's a great
language, and I would recommend <a href="https://www.python.org/about/gettingstarted/">getting started</a> with
it if you haven't already.</p>
<p>One of the nice things about programming is there is always something new to
learn about or surprise you. Recently I stumbled across a feature of Python's
loop statements that I have never seen before.</p>
<h2>for and if statements</h2>
<p>If you've done any programming before the concept of <code>for</code> and <code>if</code> statements
shouldn't surprise you. <code>for</code> statements are used to iterate over a sequence
(normally a list). For example:</p>
<pre><code>&gt;&gt;&gt; for name in ['Alice', 'Bob', 'Eve', 'Mallory']:
...     print('Hello', name)
...
Hello Alice
Hello Bob
Hello Eve
Hello Mallory
</code></pre>
<p>And <code>if</code> statements can be used conditionally to run code. For example:</p>
<pre><code>&gt;&gt;&gt; if x &gt; 0:
...     print('x is positive')
... elif x &lt; 0:
...     print('x is negative')
... else:
...     print('x is zero')
...
x is positive
</code></pre>
<p>But what happens if you add an <code>else</code> clause to a <code>for</code> statement?</p>
<h2>Loop statements with an else clause</h2>
<p>The code below is perfectly valid, all be it slightly pointless Python code:</p>
<pre><code>for x in range(5):
    print(x)
else:
    print('Running else clause..')
</code></pre>
<p>Running this will produce the following output:</p>
<pre><code>0
1
2
3
4
Running else clause...
</code></pre>
<p>So what's going on? When does the else clause not get executed? Well perhaps a
better keyword for <code>else</code>, in this context, would have been <code>nobreak</code>. The
<code>else</code> clause is only executed if the <code>for</code> statement iterates over everything
without hitting a <code>break</code> statement. Adding a <code>break</code> statement to the example
will prevent the <code>else</code> clause being executed:</p>
<pre><code>&gt;&gt;&gt; for x in range(5):
...     print(x)
...     break
... else:
...     print('Running else clause..')
...
0
</code></pre>
<h2>Practical uses</h2>
<p>One of the most common ways to use a for else loop is when searching through a
sequence. The <a href="https://docs.python.org/3.6/tutorial/controlflow.html#break-and-continue-statements-and-else-clauses-on-loops">Python docs</a> give the following
example, which determines if <code>n</code> is prime:</p>
<pre><code>for x in range(2, n):
    if n % x == 0:
        print(n, 'equals', x, '*', n//x)
        break
else:
    # loop fell through without finding a factor
    print(n, 'is a prime number')
</code></pre>
<p>This removes the need for having a flag variable; with a flag variable the code
would look something like this:</p>
<pre><code>is_prime = True
for x in range(2, n):
    if n % x == 0:
        print(n, 'equals', x, '*', n//x)
        is_prime = False
        break
if is_prime:
    # loop fell through without finding a factor
    print(n, 'is a prime number')
</code></pre>
<h2>Other uses of else</h2>
<p>There are actually a few other places you can use an <code>else</code> clause. While loops
work in much the same way for loops do:</p>
<pre><code>&gt;&gt;&gt; i = 1
&gt;&gt;&gt; while i &lt; 5:
...     print('i: ', i)
...     if i % 3 == 0:
...         break
...     else:
...         i += 1
... else:
...     print('"i" was never divisible by 3')
...
i:  1
i:  2
i:  3
</code></pre>
<p>You can also have an <code>else</code> clause following a <code>try</code> statement:</p>
<pre><code>&gt;&gt;&gt; try:
...     x = 5/1
... except ZeroDivisionError:
...     print('Dividing by zero...')
... else:
...     print("We didn't divide by zero")
...
We didn't divide by zero
</code></pre>
<p>In the example above the <code>else</code> clause is executed if the <code>try</code> clause is
completed without raising an error. However unlike code in the <code>try</code> clause,
exceptions raised in the <code>else</code> clause are not handled by any preceeding
<code>except</code> clauses.</p>
<h2>Further reading</h2>
<p>If you're still curious I would recommend reading the Python documentation on
<a href="https://docs.python.org/3.6/tutorial/controlflow.html">control flow</a> and <a href="https://docs.python.org/3.6/reference/compound_stmts.html">compound
statements</a>.</p>
<p>If after that you're still curious, <a href="http://web.archive.org/web/20130731202547/http://pplab.snu.ac.kr/courses/adv_pl05/papers/p261-knuth.pdf">Structured Programming with go to
Statements</a> by <a href="https://en.wikipedia.org/wiki/Donald_Knuth">Donald Knuth</a> is worth a
read. It gives an interesting historical perspective on structured programming,
before it was as ubiquitous as it is today.</p>
  </article>
  <footer class="footer pure-u-1 pure-u-md-3-4">
    <hr />
    <small>
      Copyright &copy; 2020 Floating Octothorpe. Except where
      otherwise noted, content on this site is licensed under a
      <a rel="license"
         href="https://creativecommons.org/licenses/by/4.0/">Creative Commons
          Attribution 4.0 License</a>.
    </small>
  </footer>
</body>
</html>